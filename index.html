<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>THE ICONIC LAB</title>
<!-- CSS -->
  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
  <!-- Optional theme -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">
<!-- END CSS -->
  </head>
  <body>
    <div class="container">
    <div class="text-center">

      <div style="background-color:#1a1a1a" class="">
        <h1 style="color:white">Hello world \m/</h1>
      </div><!-- /tittle -->

      <div class="row">
        <div class="col-lg-12">
          <div class="input-group">
            <input id="search" type="search" class="form-control" placeholder="enter a keyword">
            <span class="input-group-btn">
              <button id="search-btn" class="btn btn-success" type="button">Search</button>
            </span>
          </div><!-- /input-group -->
        </div><!-- /.col-lg-12 -->
      </div><!-- /.row -->

      <!--list-->
      <div class="row">
        <div class="col-lg-12">
            <div id="item_list">

            </div>
        </div><!-- /.col-lg-12 -->
      </div><!-- /.row -->
      <!--END list-->






    </div><!-- /text-center -->
    </div><!-- /container -->


  </body>
<!--JS CDN-->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.3/jquery.min.js"></script>
  <!-- Latest compiled and minified JavaScript -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
<!--END JS CDN-->
<!--HandMade JS-->
  <script type="text/javascript">
      //function to validate key pressed and search
        var search_keyup = function(e){(e.which == 13)?search():false;};
        var search = function(){
          var search_key = $("#search").val();
          iList.loadlist(search_key);
        };
        //setting the button action
        $("#search").keyup(search_keyup);
        $("#search-btn").click(search);
        $("#search").focus();
      //END function to validate key pressed and search




      var iList = (function(){
        //vars
        var jsonlist = {};

        //private methods
        var add_item = function(name,price,sku,brand,imgsource,link,total_items){

          var temp_ = "<div class='col-md-6'> \
                        <div class='media'> \
                          <div class='media-left'> \
                            <a href='http://www.theiconic.com.au/"+link+"'> \
                              <img style='width: 100px' class='media-object' src='"+imgsource+"' alt='"+name+"'> \
                            </a> \
                          </div><!-- /.media-left --> \ \
                          <div class='media-right'> \
                            <a href='http://www.theiconic.com.au/"+link+"'> \
                              <h3 class='media-heading'>"+brand+"&nbsp;"+name+"</h3> \
                            </a> \
                            <p>"+price+"</p> \
                            <p>"+sku+"</p> \
                            </div><!-- /.media-right --> \
                        </div><!-- /.media --> \
                      </div><!-- /.col-md-6 -->";
          total_items.push(temp_);
          return true;

        };
        //diferent functions for loading array and paint_items makes it possible to change presentation withtout reloading
        var paint_items = function(total_items){
 //
          var output = "";
          for (var i = 0; i < total_items.length; i++) {

            if (i % 2 === 0) {
              output += "<div class='row'>";
              output += total_items[i];
            } else {
              output += total_items[i];
            }

            if ((i-1) % 2 === 0) {
              output += "</div><!-- /.row -->";
            }

          }
          $("#item_list").html(output);
          return true;

        };

        //public methods
        var publicAPI = {

              loadlist: function(search_key){

                  $.ajax({

                      url: "https://eve.theiconic.com.au/v1/catalog/products?q="+search_key+"&page=1&page_size=10",
                      context: document.body

                  }).done(function(data) {

                    var total_items = new Array();
                    jsonlist = data._embedded.product;
                    for (var i = 0; i < 10; i++) {
                      add_item(jsonlist[i].name,jsonlist[i].price,jsonlist[i].sku,jsonlist[i]._embedded.brand.name,jsonlist[i]._embedded.images[0].thumbnail,jsonlist[i].link,total_items);
                    };

                    paint_items(total_items);
                    //console.log(jsonlist);
                    console.log(total_items);

                  });

              }

        };// END publicAPI definition
        return publicAPI;

      })();


  </script>
<!--END HandMade JS-->
</html>
